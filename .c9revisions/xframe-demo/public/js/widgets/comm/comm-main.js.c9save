{"ts":1401166770258,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"if(typeof window === 'undefined' && typeof importScripts === 'function') {\n\timportScripts(\"/js/lib/require/require.js\");\n}\n\nrequire.config({ paths: { pathConfig : '/js/infrastructure/pathConfig' }});\n\nrequire([ 'pathConfig' ], function(){\n\trequire([\n\t\t'socketio',\n\t    'postal.xframe'\n\t], function(io, postal) {\n\n\t\tpostal.instanceId(\"comm\");\n\t\tpostal.fedx.addFilter([\n\t\t\t{ channel: 'ctrl',           topic: '#',             direction: 'in'  },\n\t\t\t{ channel: 'language-stats', topic: '#',             direction: 'out' },\n\t\t\t{ channel: 'hashtag-stats',  topic: '#',             direction: 'out' },\n\t\t\t{ channel: 'user-stats',     topic: '#',             direction: 'out' },\n\t\t\t{ channel: 'search',         topic: 'batch.results', direction: 'out' },\n\t\t\t{ channel: 'search',         topic: 'started',       direction: 'out' }\n\t\t]);\n\t\t/*postal.addWireTap(function(d, e) {\n\t\t\tconsole.log(\"ID: \" + postal.instanceId() + \" - \" + JSON.stringify(e, null, 4));\n\t\t});*/\n\n\t\tvar socket = io.connect(location.origin || location.protocol + \"//\" + location.host);\n\t\tsocket.on('postal.batch', function (batch) {\n\t\t\t_.each(batch, postal.publish);\n\t\t});\n\t\tsocket.on('search.started', function (data) {\n\t\t\tpostal.publish({\n\t\t\t\tchannel : \"search\",\n\t\t\t\ttopic   : \"started\",\n\t\t\t\tdata    : data\n\t\t\t});\n\t\t});\n\n\t\tpostal.subscribe({\n\t\t\tchannel : \"ctrl\",\n\t\t\ttopic   : \"search.start\",\n\t\t\tcallback: function(d, e) {\n\t\t\t\tsocket.emit(\"search.start\", d);\n\t\t\t}\n\t\t});\n\n\t\tpostal.fedx.signalReady();\n\n\t\treturn {\n\t\t\tpostal     : postal,\n\t\t\tsocket     : socket\n\t\t}\n\t});\n});"]],"start1":0,"start2":0,"length1":0,"length2":1534}]],"length":1534}
