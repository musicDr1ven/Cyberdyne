{"ts":1401166655239,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"global._           = require('underscore');\nvar machina        = require('machina')(global._);\nvar Monologue      = require('monologue.js')(global._);\nvar postal         = require(\"postal\")(global._);\nvar monopost       = require('monopost')(global._, Monologue, postal);\nvar express        = require('express');\nvar app            = express();\nvar server         = require('http').createServer(app);\nvar Searcher       = require('./lib/twitterSearch')(global._, Monologue);\nvar io             = require('socket.io').listen(server);\nvar CountByUser    = require('./lib/countByUser')(global._, Monologue);\nvar CountByHashtag = require('./lib/countByHashtag')(global._, Monologue);\nvar PercentByLang  = require('./lib/percentageByLanguage')(global._, Monologue);\nvar BatchManager   = require('./lib/batchManager')(global._, machina, Monologue, io);\n\n\nvar main = module.exports = {\n\tinit: function() {\n\t\tserver.listen(8088);\n\t\tapp.use(express.static(__dirname + '/public'));\n\t\tio.set('log level', 1);\n\n\t\tthis.searcher.on(\"search.started\", function(data){\n\t\t\tio.sockets.emit( \"search.started\", data );\n\t\t});\n\n\t\tio.sockets.on('connection', function (socket) {\n\t\t\tconsole.log(\"client connected\");\n\t\t\tpostal.publish({\n\t\t\t\tchannel: \"search\",\n\t\t\t\ttopic: \"stop\"\n\t\t\t});\n\t\t\tsocket.on('search.start', function (data) {\n\t\t\t\tdata = data || {};\n\t\t\t\tpostal.publish({\n\t\t\t\t\tchannel: \"search\",\n\t\t\t\t\ttopic: \"start\",\n\t\t\t\t\tdata: data.searchQry || \"JavaScript\"\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\n\tbatchManager: new BatchManager(),\n\n\tsearcher: new Searcher(),\n\n\tpostal: postal,\n\n\tprocessors: [\n\t\tnew CountByUser(),\n\t    new CountByHashtag(),\n\t    new PercentByLang()\n\t]\n};\n\nmain.searcher.on(\"#\", function(d, e) {\n\tif( e.topic !== \"batch.results\") {\n\t\tconsole.log( e.topic + \" \" + (d||\"\"));\n\t}\n});\n\nmain.init();"]],"start1":0,"start2":0,"length1":0,"length2":1776}]],"length":1776}
